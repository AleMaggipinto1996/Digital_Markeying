, aes(x=LAST_COD_FID, y=PERCENT,fill=LAST_COD_FID)) +
geom_bar(stat="identity", colour="black") +
scale_fill_manual(values = c("PREMIUM" = "blue2",
"PREMIUM BIZ" = "red1",
"STANDARD" = "blue2",
"STANDARD BIZ" = "red1"))
ggplotly(plot_d)
plot_d <- ggplot(data=df1_dist_codfid
, aes(x=LAST_COD_FID, y=PERCENT,fill=LAST_COD_FID)) +
geom_bar(stat="identity", colour="black") +
scale_fill_manual(values = c("PREMIUM" = "blue2",
"PREMIUM BIZ" = "red1",
"STANDARD" = "blue",
"STANDARD BIZ" = "red1"))
ggplotly(plot_d)
plot_d <- ggplot(data=df1_dist_codfid
, aes(x=LAST_COD_FID, y=PERCENT,fill=LAST_COD_FID)) +
geom_bar(stat="identity", colour="black") +
scale_fill_manual(values = c("PREMIUM" = "blue2",
"PREMIUM BIZ" = "green3",
"STANDARD" = "blue",
"STANDARD BIZ" = "green"))
ggplotly(plot_d)
plot_d <- ggplot(data=df1_dist_codfid
, aes(x=LAST_COD_FID, y=PERCENT,fill=LAST_COD_FID)) +
geom_bar(stat="identity", colour="black") +
scale_fill_manual(values = c("PREMIUM" = "blue3",
"PREMIUM BIZ" = "green3",
"STANDARD" = "blue",
"STANDARD BIZ" = "green"))
ggplotly(plot_d)
plot_d <- ggplot(data=df1_dist_codfid
, aes(x=LAST_COD_FID, y=PERCENT,fill=LAST_COD_FID)) +
geom_bar(stat="identity", colour="black") +
scale_fill_manual(values = c("PREMIUM" = "blue4",
"PREMIUM BIZ" = "green4",
"STANDARD" = "blue",
"STANDARD BIZ" = "green"))
ggplotly(plot_d)
df1_persone_codfid_ld
df1_p_codfid_status <- df_1_persone %>%
group_by(LAST_STATUS_FID) %>%
dplyr::summarize(TOT_CLIs = n_distinct(ID_CLI)) %>%
mutate(PERCENT = TOT_CLIs/sum(TOT_CLIs)*100) %>%
arrange(desc(PERCENT))
df1_p_codfid_status  # il 99.2% dei clienti "persone" ha una tessera fedeltà attiva
## plot distribution
plot_df1_p_codfid_status <- (
ggplot(data=df1_p_codfid_status
, aes(x=LAST_STATUS_FID, y=PERCENT)
) +
geom_bar(stat="identity"
, fill="steelblue") +
theme_minimal()
)
ggplotly(plot_df1_p_codfid_status)
plot_d <- ggplot(data=df1_dist_codfid
, aes(x=LAST_COD_FID, y=PERCENT,fill=LAST_COD_FID)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("PREMIUM" = "blue4",
"PREMIUM BIZ" = "green4",
"STANDARD" = "blue",
"STANDARD BIZ" = "green"))
ggplotly(plot_d)
df1_p_codfid_main <- df_1_persone %>%
group_by(LAST_TYP_CLI_FID) %>%
dplyr::summarize(TOT_CLIs = n_distinct(ID_CLI)) %>%
mutate(PERCENT = TOT_CLIs/sum(TOT_CLIs)*100) %>%
arrange(desc(PERCENT))
df1_p_codfid_main #L'ultima tessera fedelt? attivata dai clienti nel 98.4% dei casi
#? una tessera principale (328388 casi), mentre nell'1.6% dei casi
#(5246 casi) abbiamo che la tessera attivata ? secondaria
## plot distribution
plot_df1_p_codfid_main <- (
ggplot(data=df1_p_codfid_main
, aes(x=LAST_TYP_CLI_FID, y=PERCENT)
) +
geom_bar(stat="identity"
, fill="steelblue") +
theme_minimal()
)
ggplotly(plot_df1_p_codfid_main)
df1_p_codfid_neg <- df_1_cli_fid_clean %>%
group_by(RegOnline) %>%
dplyr::summarize(TOT_CLIs = n_distinct(ID_CLI)) %>%
mutate(PERCENT = TOT_CLIs/sum(TOT_CLIs)*100) %>%
arrange(desc(PERCENT))
df1_p_codfid_neg
## plot distribution
plot_df1_p_codfid_neg <- (
ggplot(data=df1_p_codfid_neg
, aes(x=RegOnline, y=PERCENT)
) +
geom_bar(stat="identity"
, fill="steelblue") +
theme_minimal()
)
ggplotly(plot_df1_p_codfid_neg)
df_4_p_flag1_distrib <- df4_persone %>%
group_by(FLAG_PRIVACY_1) %>%
dplyr::summarize(TOT_IDs = n_distinct(ID_CLI)) %>%
mutate(PERCENT = TOT_IDs/sum(TOT_IDs)*100) %>%
arrange(desc(PERCENT))
df_4_p_flag1_distrib  #il 30.9% dei clienti non ha dato il proprio consenso
## plot distribution
plot_df_4_p_flag1_distrib <- (
ggplot(data=df_4_p_flag1_distrib
, aes(x=FLAG_PRIVACY_1, y=PERCENT)) +
geom_bar(stat="identity"
, fill="steelblue") +
theme_minimal()
)
ggplotly(plot_df_4_p_flag1_distrib)
df_4_cli_p_flag2_distrib <- df4_persone %>%
group_by(FLAG_PRIVACY_2) %>%
dplyr::summarize(TOT_IDs = n_distinct(ID_CLI)) %>%
mutate(PERCENT = TOT_IDs/sum(TOT_IDs)*100) %>%
arrange(desc(PERCENT))
df_4_cli_p_flag2_distrib   #solo il 7.1% non ha dato il consenso
## plot distribution
plot_df_4_p_flag2_distrib <- (
ggplot(data=df_4_cli_p_flag2_distrib
, aes(x=FLAG_PRIVACY_2, y=PERCENT)) +
geom_bar(stat="identity"
, fill="steelblue") +
theme_minimal()
)
ggplotly(plot_df_4_p_flag2_distrib)
df_4_p_flag_mkt_distrib <- df4_persone %>%
group_by(FLAG_DIRECT_MKT) %>%
dplyr::summarize(TOT_IDs = n_distinct(ID_CLI)) %>%
mutate(PERCENT = TOT_IDs/sum(TOT_IDs)*100) %>%
arrange(desc(PERCENT))
df_4_p_flag_mkt_distrib #il 29% dei clienti non ha dato il consenso
# con questi l'azienda non potrà comunicare al meglio
## plot distribution
plot_df_4_p_flag_mkt_distrib <- (
ggplot(data=df_4_p_flag_mkt_distrib
, aes(x=FLAG_DIRECT_MKT, y=PERCENT)) +
geom_bar(stat="identity"
, fill="steelblue") +
theme_minimal()
)
ggplotly(plot_df_4_p_flag_mkt_distrib)
plot_df5_TYP_CAMP_distribution=ggplot(df_5_camp_cat_type_camp, aes(TYP_CAMP,TOT_TYP_CAMPS))+
geom_bar(stat="identity", fill="steelblue")+
theme_minimal()+
labs(y="Numero di campagne attivate", x="Tipologia di Campagna")+
ggtitle("Tipologia di campagna" )
plot_df5_TYP_CAMP_distribution
plot_df5_TYP_CAMP_distribution
df_5_camp_cat_type_camp <- df_5_camp_cat_clean %>%
group_by(TYP_CAMP) %>%
dplyr::summarize(TOT_IDs = n_distinct(ID_CAMP)) %>%
mutate(PERCENT = TOT_IDs/sum(TOT_IDs)) %>%
arrange(desc(PERCENT))
df_5_camp_cat_type_camp
plot_df5_TYP_CAMP_distribution
plot_df5_TYP_CAMP_distribution=ggplot(df_5_camp_cat_type_camp, aes(TYP_CAMP,TOT_TYP_CAMPS))+
geom_bar(stat="identity", fill="steelblue")+
theme_minimal()+
labs(y="Numero di campagne attivate", x="Tipologia di Campagna")+
ggtitle("Tipologia di campagna" )
plot_df5_TYP_CAMP_distribution
df_5_camp_cat_clean
View(plot_df_4_p_flag_mkt_distrib)
plot_df5_TYP_CAMP_distribution <- ggplot(df_5_camp_cat_type_camp, aes(x=TYP_CAMP,y=PERCENT))+
geom_bar(stat="identity", fill="steelblue")+
theme_minimal()+
labs(y="Numero di campagne attivate", x="Tipologia di Campagna")+
ggtitle("Tipologia di campagna" )
plot_df5_TYP_CAMP_distribution
ggplotly(plot_df5_TYP_CAMP_distribution)
df_5_camp_cat_type_camp <- df_5_camp_cat_clean %>%
group_by(TYP_CAMP) %>%
dplyr::summarize(TOT_IDs = n_distinct(ID_CAMP)) %>%
mutate(PERCENT = TOT_IDs/sum(TOT_IDs)) %>%
arrange(desc(PERCENT)*100)
df_5_camp_cat_type_camp
plot_df5_TYP_CAMP_distribution <- ggplot(df_5_camp_cat_type_camp, aes(x=TYP_CAMP,y=PERCENT))+
geom_bar(stat="identity", fill="steelblue")+
theme_minimal()+
labs(y="Numero di campagne attivate", x="Tipologia di Campagna")+
ggtitle("Tipologia di campagna" )
ggplotly(plot_df5_TYP_CAMP_distribution)
df_5_camp_cat_type_camp <- df_5_camp_cat_clean %>%
group_by(TYP_CAMP) %>%
dplyr::summarize(TOT_IDs = n_distinct(ID_CAMP)) %>%
mutate(PERCENT = TOT_IDs/sum(TOT_IDs)*100) %>%
arrange(desc(PERCENT))
df_5_camp_cat_type_camp
plot_df5_TYP_CAMP_distribution <- ggplot(df_5_camp_cat_type_camp, aes(x=TYP_CAMP,y=PERCENT))+
geom_bar(stat="identity", fill="steelblue")+
theme_minimal()+
labs(y="Numero di campagne attivate", x="Tipologia di Campagna")+
ggtitle("Tipologia di campagna" )
ggplotly(plot_df5_TYP_CAMP_distribution)
df6_dist_opened <- df_6_persone %>%
group_by(OPENED) %>%
summarize(TOT_EVENTs = n_distinct(ID_EVENT_S)
, TOT_CLIs = n_distinct(ID_CLI)) %>%
mutate(TYP_CAMP = 'ALL') %>%
mutate(PERCENT_EVENTs = TOT_EVENTs/df6_overview$TOT_EVENTs*100
, PERCENT_CLIs = TOT_CLIs/df6_overview$TOT_CLIs)
df6_dist_opened
## plot aggregate
plot_df6_dist_opened <- (
ggplot(data=df6_dist_opened
, aes(fill=OPENED, x=TYP_CAMP, y=PERCENT_EVENTs)) +
geom_bar(stat="identity", position="fill") +
theme_minimal()
)
plot_df6_dist_opened
plot_df6_dist_opened
ggplotly(plot_df6_dist_opened)
df6_dist_opened <- df_6_persone %>%
group_by(OPENED) %>%
summarize(TOT_EVENTs = n_distinct(ID_EVENT_S)
, TOT_CLIs = n_distinct(ID_CLI)) %>%
mutate(TYP_CAMP = 'ALL') %>%
mutate(PERCENT_EVENTs = (TOT_EVENTs/df6_overview$TOT_EVENTs)*100
, PERCENT_CLIs = TOT_CLIs/df6_overview$TOT_CLIs)
df6_dist_opened
plot_df6_dist_opened <- (
ggplot(data=df6_dist_opened
, aes(fill=OPENED, x=TYP_CAMP, y=PERCENT_EVENTs)) +
geom_bar(stat="identity", position="fill") +
theme_minimal()
)
ggplotly(plot_df6_dist_opened)
plot_df6_dist_openedbytyp
plot_df6_dist_openedbytyp_percent
ggplotly(plot_df6_dist_openedbytyp_percent)
ggplotly(plot_df6_dist_openedbytyp)
plot_df6_dist_daystoopen
plot_df6_dist_daystoopen_vs_cumulate
ggplotly(plot_df6_dist_daystoopen_vs_cumulate)
plot_df6_dist_clickedbytyp
ggplotly(plot_df6_dist_clickedbytyp)
plot_df6_dist_clickedbytyp_percent
ggplotly(plot_df6_dist_clickedbytyp_percent)
plot_df6_dist_failedbytyp
ggplotly(plot_df6_dist_failedbytyp_percent)
plot_df6_dist_num_opens
ggplotly(plot_df6_dist_num_opens)
ggplotly(plot_dist_df6_num_opens)
plot_df6_dist_num_clicks
ggplotly(plot_df6_dist_num_clicks)
ggplotly(plot_dist_df6_num_clicks)
ggplotly(plot_df7_dist_hour_percent)
ggplotly(plot_df7_dist_dep)
df7_avgimpscntcli
plot_df7_avgscntcli
plot_df7_avgimpcli
df7_dist_avgimprep
df7_dist_avgimprep[which.max(df7_dist_avgimprep$IMPORTO_MEDIO),]
df7_dist_avgimprep[which.min(df7_dist_avgimprep$IMPORTO_MEDIO),]
df7_dist_avgscntrep <- df_7_tic_clean %>% filter(DIREZIONE==1)  %>% group_by(COD_REPARTO) %>%
summarise(SCONTO_MEDIO = mean(SCONTO))
ggplot(df7_dist_avgimprep,aes(x=COD_REPARTO,y=IMPORTO_MEDIO))+
geom_bar(stat = "identity",fill="coral")+
theme_minimal()
ggplot(df7_dist_avgscntrep,aes(x=COD_REPARTO,y=SCONTO_MEDIO))+
geom_bar(stat = "identity",fill="lightgreen")+
theme_minimal()
df_for_next_purchase_curve
plot_df7_nxtpurch
df7_dist_purch_cat
df7_dist_purch_cat
df7_dist_avgimprep <- df_7_persone %>% group_by(COD_REPARTO) %>%
summarise(IMPORTO_MEDIO = mean(IMPORTO_LORDO))
df7_dist_avgimprep
df7_avgil <- df_7_persone %>% group_by(COD_REPARTO) %>%
summarise(IMPORTO_MEDIO = mean(IMPORTO_LORDO))
df7_avgilsc
df7_avgil [which.max(df7_avgilsc $IMPORTO_MEDIO),]
df7_avgil [which.min(df7_avgilsc $IMPORTO_MEDIO),]
df7_avgsc <- df_7_persone %>% filter(DIREZIONE==1)  %>% group_by(COD_REPARTO) %>%
summarise(SCONTO_MEDIO = mean(SCONTO))
df7_avgil <- df_7_persone %>% group_by(COD_REPARTO) %>%
summarise(IMPORTO_MEDIO = mean(IMPORTO_LORDO))
df7_avgil
df7_avgil [which.max(df7_avgil$IMPORTO_MEDIO),]
df7_avgil [which.min(df7_avgil$IMPORTO_MEDIO),]
df7_avgsc <- df_7_persone %>% filter(DIREZIONE==1)  %>% group_by(COD_REPARTO) %>%
summarise(SCONTO_MEDIO = mean(SCONTO))
df7_avgsc[which.max(df7_dist_avgsc$SCONTO_MEDIO),]
df7_avgsc[which.min(df7_dist_avgsc$SCONTO_MEDIO),]
df7_avgsc <- df_7_persone %>% filter(DIREZIONE==1)  %>% group_by(COD_REPARTO) %>%
summarise(SCONTO_MEDIO = mean(SCONTO))
df7_avgsc[which.max(df7_avgsc$SCONTO_MEDIO),]
df7_avgsc[which.min(df7_avgsc$SCONTO_MEDIO),]
ggplot(df7_avgiml,aes(x=COD_REPARTO,y=IMPORTO_MEDIO))+
geom_bar(stat = "identity",fill="red")+
theme_minimal()
ggplot(df7_dist_avgsc,aes(x=COD_REPARTO,y=SCONTO_MEDIO))+
geom_bar(stat = "identity",fill="blue")+
theme_minimal()
IL<-ggplot(df7_avgil,aes(x=COD_REPARTO,y=IMPORTO_MEDIO))+
geom_bar(stat = "identity",fill="red")+
theme_minimal()
SC<-ggplot(df7_avgsc,aes(x=COD_REPARTO,y=SCONTO_MEDIO))+
geom_bar(stat = "identity",fill="blue")+
theme_minimal()
IL<-ggplot(df7_avgil,aes(x=COD_REPARTO,y=IMPORTO_MEDIO))+
geom_bar(stat = "identity",fill="red")+
theme_minimal()
IL
ggplotly(IL)
ggplotly(IL)
SC<-ggplot(df7_avgsc,aes(x=COD_REPARTO,y=SCONTO_MEDIO))+
geom_bar(stat = "identity",fill="blue")+
theme_minimal()
ggplotly(IL)
SC<-ggplot(df7_avgsc,aes(x=COD_REPARTO,y=SCONTO_MEDIO))+
geom_bar(stat = "identity",fill="blue")+
theme_minimal()
ggplotly(SC)
ggplot(df7_dist_articolo,aes(x=ID_ARTICOLO,y=TOT_SCONTRINI))+
geom_bar(stat = "identity")
df7_dist_articolo<-df_7_tic_clean_final %>% group_by(ID_ARTICOLO,DIREZIONE) %>%
summarise(TOT_SCONTRINI = n_distinct(ID_SCONTRINO),
TOT_CLIENTI = n_distinct(ID_CLI))
df7_dist_articolo[which.max(df7_dist_articolo$TOT_SCONTRINI),]
#L'articolo pi? acquistato ? il 33700716, acquistato 57806 volte
#da 36273 clienti diversi
df7_dist_articolo
ggplot(df7_dist_articolo,aes(x=ID_ARTICOLO,y=TOT_SCONTRINI))+
geom_bar(stat = "identity")
df7_dist_articolo<-df_7_tic_clean_final %>% group_by(ID_ARTICOLO,DIREZIONE) %>%
summarise(TOT_SCONTRINI = n_distinct(ID_SCONTRINO),
TOT_CLIENTI = n_distinct(ID_CLI))
df7_dist_articolo[which.max(df7_dist_articolo$TOT_SCONTRINI),]
df7_articolo_max_tics<-df_7_persone %>% group_by(ID_ARTICOLO,DIREZIONE) %>%
summarise(TOT_SCONTRINI = n_distinct(ID_SCONTRINO),
TOT_CLIENTI = n_distinct(ID_CLI))
df7_articolo_max_tics[which.max(df7_articolo$TOT_SCONTRINI),]
df7_articolo_max_tics<-df_7_persone %>% group_by(ID_ARTICOLO,DIREZIONE) %>%
summarise(TOT_SCONTRINI = n_distinct(ID_SCONTRINO),
TOT_CLIENTI = n_distinct(ID_CLI))
df7_articolo_max_tics[which.max(df7_articolo_max_tics$TOT_SCONTRINI),]
df7_purch <- df_7_persone %>% filter(DIREZIONE == 1) %>%
group_by(ID_CLI) %>%
summarise(TOT_ACQUISTI = n_distinct(ID_SCONTRINO)) %>%
arrange(desc(TOT_ACQUISTI))
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "dai 5 ai 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "dai 25 ai 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "dai 50 ai 100",
(TOT_ACQUISTI>=100) ~ "pi? di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 20 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
plot_df7_sub_purch <- ggplot(df7_sub_purch,aes(CAT,TOT))+
geom_bar(fill="darkblue",stat = "identity",width=0.4)+
xlab("N° acquisti")+
ylab("N° clienti")
plot_df7_dist_purch_cat
plot_df7_sub_purch <- ggplot(df7_sub_purch,aes(CAT,TOT))+
geom_bar(fill="red4",stat = "identity",width=0.4)+
xlab("N° acquisti")+
ylab("N° clienti")
plot_df7_dist_purch_cat
plot_df7_sub_purch
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "dai 5 ai 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "dai 25 ai 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "dai 50 ai 100",
(TOT_ACQUISTI>=100) ~ "pi? di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 20 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
df7_purch <- df_7_persone %>% filter(DIREZIONE == 1) %>%
group_by(ID_CLI) %>%
summarise(TOT_ACQUISTI = n_distinct(ID_SCONTRINO)) %>%
arrange(desc(TOT_ACQUISTI))
df7_purch
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "dai 5 ai 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "dai 25 ai 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "dai 50 ai 100",
(TOT_ACQUISTI>=100) ~ "pi? di 100"))
df7_sub_purch
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 20 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
df7_purch <- df_7_persone %>% filter(DIREZIONE == 1) %>%
group_by(ID_CLI) %>%
summarise(TOT_ACQUISTI = n_distinct(ID_SCONTRINO)) %>%
arrange(desc(TOT_ACQUISTI))
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "dai 5 ai 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "dai 25 ai 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "dai 50 ai 100",
(TOT_ACQUISTI>=100) ~ "pi? di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 25 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
plot_df7_sub_purch <- ggplot(df7_sub_purch,aes(CAT,TOT))+
geom_bar(fill="red4",stat = "identity",width=0.4)+
xlab("N° acquisti")+
ylab("N° clienti")
plot_df7_sub_purch
plot_df7_sub_purch
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "dai 5 ai 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "dai 25 ai 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "dai 50 ai 100",
(TOT_ACQUISTI>=100) ~ "più di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 25 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "dai 10 ai 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "dai 25 ai 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "dai 50 ai 100",
(TOT_ACQUISTI>=100) ~ "più di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 25 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
f7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "da 10 a 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "da 25 a 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "da 50 a 100",
(TOT_ACQUISTI>=100) ~ "più di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 25 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "da 10 a 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "da 25 a 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "da 50 a 100",
(TOT_ACQUISTI>=100) ~ "più di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 25 a 50","da 50 a 100",
"piu' di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
df7_sub_purch <- df7_purch %>%
mutate(CATEGORIA = case_when((TOT_ACQUISTI>=1) & (TOT_ACQUISTI<10) ~ "meno di 10",
(TOT_ACQUISTI>=10) & (TOT_ACQUISTI<25) ~ "da 10 a 25",
(TOT_ACQUISTI>=25) & (TOT_ACQUISTI<50) ~ "da 25 a 50",
(TOT_ACQUISTI>=50) & (TOT_ACQUISTI<100) ~ "da 50 a 100",
(TOT_ACQUISTI>=100) ~ "più di 100"))
df7_sub_purch <- df7_sub_purch %>%
mutate(CAT = factor(CATEGORIA,levels=c("meno di 10","da 10 a 25",
"da 25 a 50","da 50 a 100",
"più di 100"))) %>%
group_by(CAT) %>%
summarise(TOT = n_distinct(ID_CLI)) %>%
mutate(PERC_CLIENTI = TOT/sum(TOT),
CUM_PERC_CLIENTI = cumsum(PERC_CLIENTI))
df7_sub_purch
plot_df7_sub_purch <- ggplot(df7_sub_purch,aes(CAT,TOT))+
geom_bar(fill="red4",stat = "identity",width=0.4)+
xlab("N° acquisti")+
ylab("N° clienti")
plot_df7_sub_purch

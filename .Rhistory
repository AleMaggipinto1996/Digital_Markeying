quote = TRUE
)
write.table(df_7_p, "df_7_p.csv",
sep = ";",             # punto e virgola
row.names = FALSE,     # se abbiamo la variabile ID
dec = ",",             # separatore di decimali
na = "",               # dati mancanti come celle vuote
quote = TRUE
)
write.table(df_7_a, "df_7_a.csv",
sep = ";",             # punto e virgola
row.names = FALSE,     # se abbiamo la variabile ID
dec = ",",             # separatore di decimali
na = "",               # dati mancanti come celle vuote
quote = TRUE
)
df_7_a<- df_az %>% mutate(GUADAGNO = IMPORTO_LORDO - SCONTO)
library(carData)
write.table(df_7_a, "df_7_a.csv",
sep = ";",             # punto e virgola
row.names = FALSE,     # se abbiamo la variabile ID
dec = ",",             # separatore di decimali
na = "",               # dati mancanti come celle vuote
quote = TRUE
)
somma_a <- sum(df_7_a$GUADAGNO)
somma_p <- sum(df_7_p$GUADAGNO)
measure_matrix_az =matrix(0,ncol = 2,nrow = 2)
colnames(measure_matrix_az) <- c("guadagno_persone","Guadagno_aziende")
rownames(measure_matrix_az) <- c("aziende","persone")
matrice_guadagno =matrix(0,ncol = 2,nrow = 2)
colnames(measure_matrix_az) <- c("guadagno_persone","Guadagno_aziende")
rownames(measure_matrix_az) <- c("aziende","persone")
View(matrice_guadagno)
rownames(measure_matrix_az) <- c("aziende","persone")
matrice_guadagno =matrix(0,ncol = 2,nrow = 1)
colnames(measure_matrix_az) <- c("guadagno")
matrice_guadagno =matrix(0,ncol = 1,nrow = 2)
colnames(measure_matrix_az) <- c("guadagno")
matrice_guadagno =matrix(0,ncol = 1,nrow = 2)
colnames(matrice_guadagno) <- c("guadagno")
rownames(matrice_guadagno) <- c("aziende","persone")
matrice_guadagno[1,] <- c(somma_a, somma_p)
matrice_guadagno[,1] <- c(somma_a, somma_p)
View(matrice_guadagno)
matrice_guadagno <- as.data.frame(matrice_guadagno)
View(matrice_guadagno)
plot(matrice_guadagno)
write.table(matrice_guadagno, "guad.csv",
sep = ";",             # punto e virgola
row.names = FALSE,     # se abbiamo la variabile ID
dec = ",",             # separatore di decimali
na = "",               # dati mancanti come celle vuote
quote = TRUE
)
View(matrice_guadagno)
options(scipen=999)
set.seed(123456)
#### LIBRARIES ####
library(dplyr)
library(ggplot2)
library(ggthemes)
library(magrittr)
library(pander)
library(tidyverse)
library(wesanderson)
library(forcats)
library(lubridate)
library(RQuantLib)
library(rfm)
library(scales)
library(arules)
library(arulesViz)
library(RColorBrewer)
library(plotly)
library(randomForest)
library(ipred)
library(rpart)
library(pROC)
library(forcats)
library(RQuantLib)
library(caret)
library(rpart.plot)
library(MLmetrics)
library(e1071)
library(funModeling)
#### DIRECTORIES ####
getwd()
working_dir = "C:/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "C:/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
PIPELINE_scripts <- c(
#'B01_ingestion.R'
'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
working_dir = "Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "C:/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
#### DIRECTORIES ####
getwd()
working_dir = "Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "C:/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
working_dir = "Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "C:/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
working_dir = "Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "C:/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
working_dir = "C:/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "C:/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "C:/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
#writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
df_1_cli_fid_first <- df_1_cli_fid_clean %>%
group_by(ID_CLI) %>%
filter(DT_ACTIVE == min(DT_ACTIVE)) %>%
arrange(ID_FID) %>%
filter(row_number() == 1) %>%
ungroup() %>%
as.data.frame()
# there could be subscriptions at the same dates [possibly for technical reasons]
df_1_cli_fid %>% filter(ID_CLI == 320880)
options(scipen=999)
set.seed(123456)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
options(scipen=999)
set.seed(123456)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
# there could be subscriptions at the same dates [possibly for technical reasons]
df_1_cli_fid %>% filter(ID_CLI == 320880)
df_1_cli_fid_first <- df_1_cli_fid_clean %>%
group_by(ID_CLI) %>%
filter(DT_ACTIVE == min(DT_ACTIVE)) %>%
arrange(ID_FID) %>%
filter(row_number() == 1) %>%
ungroup() %>%
as.data.frame()
View(df_1_cli_fid_first)
options(scipen=999)
set.seed(123456)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
summary(df_1_cli_fid)
View(df_1_cli_fid)
View(df_1_cli_fid)
options(scipen=999)
set.seed(123456)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
#, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
options(scipen=999)
set.seed(123456)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
#, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
PIPELINE_scripts <- c(
'B01_ingestion.R'
#, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
options(scipen=999)
set.seed(123456)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
#, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
options(scipen=999)
set.seed(123456)
working_dir = "/Users/alessandramaggipinto/Documents/GitHub/Progetto_DigitalM"
data_dir = "/Users/alessandramaggipinto/Documents/DMktg_DSLab_Data_1"
setwd(working_dir)
PIPELINE_scripts <- c(
'B01_ingestion.R'
#, 'C01_preparation_df1.R'
, 'C02_preparation_df2.R'
, 'C03_preparation_df3.R'
, 'C04_preparation_df4.R'
, 'C05_preparation_df5.R'
, 'C06_preparation_df6.R'
, 'C07_preparation_df7.R'
, 'D01_preparation_df1_aziende.R'
, 'D02_preparation_df2_aziende.R'
, 'D03_preparation_df3_aziende.R'
, 'D04_preparation_df4_aziende.R'
, 'D05_preparation_df5_aziende.R'
, 'D06_preparation_df6_aziende.R'
, 'D07_preparation_df7_aziende.R'
, 'MBA_persone.R'
, 'MBA_aziende.R'
, 'RFM.R'
, 'RFM_aziende.R'
, 'Churn.R'
, 'Churn_aziende.R'
)
for(i in PIPELINE_scripts){
source(i, echo = TRUE)
}
rlang::last_error()
